////////////////////////////////////////////////////////////////////////////////////////////////////
// file:	Draupnir/TargetSession.cpp
//
// summary:	Implements the target session class
////////////////////////////////////////////////////////////////////////////////////////////////////

#include "TargetSession.h"

namespace Draupnir
{
	////////////////////////////////////////////////////////////////////////////////////////////////////
	TargetSession::TargetSession(SocketHandle&& handle)
		: m_handle(std::move(handle))
		, m_tlsCallbacks(m_handle.get())
		, m_sessionMgr(m_rng)
		, m_tls(m_tlsCallbacks, m_sessionMgr, m_creds, m_policy, m_rng)
	{
	}

	////////////////////////////////////////////////////////////////////////////////////////////////////
	void TargetSession::ReceivedData(const uint8_t* const data, size_t size)
	{
		m_tls.received_data(data, size);
	}
} // namespace Draupnir
